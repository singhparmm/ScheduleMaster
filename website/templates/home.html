{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block content %}
  <h1 align="center">Notes</h1>
  <ul class="list-group list-group-flush" id="notes">
    {% for note in user.notes %}
    <li class="list-group-item">
      {{ note.data }}
      <button type="button" class="close" onClick="deleteNote({{ note.id }})">
        <span aria-hidden="true">&times;</span>
      </button>
    </li>
    {% endfor %}
  </ul>

  <form id="add-note-form">
    <textarea name="note" id="note" class="form-control" rows="4" cols="50" placeholder="Enter your note here..."></textarea>
    <br />
    <div align="center">
      <input type="date" name="date" id="note-date">
      <br>
      <label for="hour">Hour:</label>
      <select name="hour" id="hour">
        {% for hour in range(24) %}
        <option value="{{ hour }}">{{ '%02d:00' % hour }}</option>
        {% endfor %}
      </select>
      <br>
      <button type="submit" class="btn btn-primary">Add Note</button>
    </div>
  </form>

  <div>
    <a href="{{ url_for('views.weekly_view') }}" class="btn">Weekly View</a>
    <a href="{{ url_for('views.monthly_view') }}" class="btn">Monthly View</a>
    <a href="{{ url_for('views.yearly_view') }}" class="btn">Yearly View</a>
  </div>

  <script>
    document.getElementById('add-note-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const date = document.getElementById('note-date').value;
      const hour = document.getElementById('hour').value;
      const content = document.getElementById('note').value;

      const response = await fetch('/add_note', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          date: date,
          hour: hour,
          content: content
        })
      });

      if (response.ok) {
        const result = await response.json();
        alert(result.message);
      } else {
        alert('Error adding note');
      }
    });
  </script>

{% endblock %}
